"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_middleware_auth_ts";
exports.ids = ["_rsc_lib_middleware_auth_ts"];
exports.modules = {

/***/ "(rsc)/./lib/auth-config.ts":
/*!****************************!*\
  !*** ./lib/auth-config.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authConfig: () => (/* binding */ authConfig),\n/* harmony export */   getJwtSecret: () => (/* binding */ getJwtSecret),\n/* harmony export */   validateAuthConfig: () => (/* binding */ validateAuthConfig),\n/* harmony export */   validatePassword: () => (/* binding */ validatePassword)\n/* harmony export */ });\n// Authentication configuration with separate secrets for customer and admin\nconst authConfig = {\n    // JWT Secrets - MUST be set in environment variables\n    customerJwtSecret: process.env.CUSTOMER_JWT_SECRET,\n    adminJwtSecret: process.env.ADMIN_JWT_SECRET,\n    // Fallback secrets (for development only)\n    fallbackCustomerSecret: \"customer-dev-secret-change-in-production\",\n    fallbackAdminSecret: \"admin-dev-secret-change-in-production\",\n    // Token expiration times (in seconds)\n    customerTokenExpiry: 24 * 60 * 60,\n    adminTokenExpiry: 7 * 24 * 60 * 60,\n    refreshTokenExpiry: 30 * 24 * 60 * 60,\n    // Rate limiting\n    maxLoginAttempts: 5,\n    lockoutDuration: 15 * 60,\n    // Password requirements\n    minPasswordLength: 8,\n    requireUppercase: true,\n    requireLowercase: true,\n    requireNumbers: true,\n    requireSpecialChars: false,\n    // Session management\n    sessionTimeout: 30 * 60,\n    maxConcurrentSessions: 3,\n    // Cookie settings\n    cookieSettings: {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"strict\",\n        path: \"/\"\n    }\n};\n// Validate environment variables\nfunction validateAuthConfig() {\n    const errors = [];\n    if (!authConfig.customerJwtSecret && \"development\" === \"production\") {}\n    if (!authConfig.adminJwtSecret && \"development\" === \"production\") {}\n    if (errors.length > 0) {\n        throw new Error(`Authentication configuration errors:\\n${errors.join(\"\\n\")}`);\n    }\n}\n// Get JWT secret based on user type\nfunction getJwtSecret(userType) {\n    if (userType === \"customer\") {\n        return authConfig.customerJwtSecret || authConfig.fallbackCustomerSecret;\n    } else {\n        return authConfig.adminJwtSecret || authConfig.fallbackAdminSecret;\n    }\n}\n// Password validation\nfunction validatePassword(password) {\n    const errors = [];\n    if (password.length < authConfig.minPasswordLength) {\n        errors.push(`Password must be at least ${authConfig.minPasswordLength} characters long`);\n    }\n    if (authConfig.requireUppercase && !/[A-Z]/.test(password)) {\n        errors.push(\"Password must contain at least one uppercase letter\");\n    }\n    if (authConfig.requireLowercase && !/[a-z]/.test(password)) {\n        errors.push(\"Password must contain at least one lowercase letter\");\n    }\n    if (authConfig.requireNumbers && !/\\d/.test(password)) {\n        errors.push(\"Password must contain at least one number\");\n    }\n    if (authConfig.requireSpecialChars && !/[!@#$%^&*(),.?\":{}|<>]/.test(password)) {\n        errors.push(\"Password must contain at least one special character\");\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC1jb25maWcudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLDRFQUE0RTtBQUNyRSxNQUFNQSxhQUFhO0lBQ3hCLHFEQUFxRDtJQUNyREMsbUJBQW1CQyxRQUFRQyxHQUFHLENBQUNDLG1CQUFtQjtJQUNsREMsZ0JBQWdCSCxRQUFRQyxHQUFHLENBQUNHLGdCQUFnQjtJQUU1QywwQ0FBMEM7SUFDMUNDLHdCQUF3QjtJQUN4QkMscUJBQXFCO0lBRXJCLHNDQUFzQztJQUN0Q0MscUJBQXFCLEtBQUssS0FBSztJQUMvQkMsa0JBQWtCLElBQUksS0FBSyxLQUFLO0lBQ2hDQyxvQkFBb0IsS0FBSyxLQUFLLEtBQUs7SUFFbkMsZ0JBQWdCO0lBQ2hCQyxrQkFBa0I7SUFDbEJDLGlCQUFpQixLQUFLO0lBRXRCLHdCQUF3QjtJQUN4QkMsbUJBQW1CO0lBQ25CQyxrQkFBa0I7SUFDbEJDLGtCQUFrQjtJQUNsQkMsZ0JBQWdCO0lBQ2hCQyxxQkFBcUI7SUFFckIscUJBQXFCO0lBQ3JCQyxnQkFBZ0IsS0FBSztJQUNyQkMsdUJBQXVCO0lBRXZCLGtCQUFrQjtJQUNsQkMsZ0JBQWdCO1FBQ2RDLFVBQVU7UUFDVkMsUUFBUXJCLGtCQUF5QjtRQUNqQ3NCLFVBQVU7UUFDVkMsTUFBTTtJQUNSO0FBQ0YsRUFBRTtBQUVGLGlDQUFpQztBQUMxQixTQUFTQztJQUNkLE1BQU1DLFNBQW1CLEVBQUU7SUFFM0IsSUFBSSxDQUFDM0IsV0FBV0MsaUJBQWlCLElBQUlDLGtCQUF5QixjQUFjLEVBRTNFO0lBRUQsSUFBSSxDQUFDRixXQUFXSyxjQUFjLElBQUlILGtCQUF5QixjQUFjLEVBRXhFO0lBRUQsSUFBSXlCLE9BQU9FLE1BQU0sR0FBRyxHQUFHO1FBQ3JCLE1BQU0sSUFBSUMsTUFBTSxDQUFDLHNDQUFzQyxFQUFFSCxPQUFPSSxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQzlFO0FBQ0Y7QUFFQSxvQ0FBb0M7QUFDN0IsU0FBU0MsYUFBYUMsUUFBOEI7SUFDekQsSUFBSUEsYUFBYSxZQUFZO1FBQzNCLE9BQU9qQyxXQUFXQyxpQkFBaUIsSUFBSUQsV0FBV08sc0JBQXNCO0lBQzFFLE9BQU87UUFDTCxPQUFPUCxXQUFXSyxjQUFjLElBQUlMLFdBQVdRLG1CQUFtQjtJQUNwRTtBQUNGO0FBRUEsc0JBQXNCO0FBQ2YsU0FBUzBCLGlCQUFpQkMsUUFBZ0I7SUFDL0MsTUFBTVIsU0FBbUIsRUFBRTtJQUUzQixJQUFJUSxTQUFTTixNQUFNLEdBQUc3QixXQUFXYyxpQkFBaUIsRUFBRTtRQUNsRGEsT0FBT0MsSUFBSSxDQUFDLENBQUMsMEJBQTBCLEVBQUU1QixXQUFXYyxpQkFBaUIsQ0FBQyxnQkFBZ0IsQ0FBQztJQUN6RjtJQUVBLElBQUlkLFdBQVdlLGdCQUFnQixJQUFJLENBQUMsUUFBUXFCLElBQUksQ0FBQ0QsV0FBVztRQUMxRFIsT0FBT0MsSUFBSSxDQUFDO0lBQ2Q7SUFFQSxJQUFJNUIsV0FBV2dCLGdCQUFnQixJQUFJLENBQUMsUUFBUW9CLElBQUksQ0FBQ0QsV0FBVztRQUMxRFIsT0FBT0MsSUFBSSxDQUFDO0lBQ2Q7SUFFQSxJQUFJNUIsV0FBV2lCLGNBQWMsSUFBSSxDQUFDLEtBQUttQixJQUFJLENBQUNELFdBQVc7UUFDckRSLE9BQU9DLElBQUksQ0FBQztJQUNkO0lBRUEsSUFBSTVCLFdBQVdrQixtQkFBbUIsSUFBSSxDQUFDLHlCQUF5QmtCLElBQUksQ0FBQ0QsV0FBVztRQUM5RVIsT0FBT0MsSUFBSSxDQUFDO0lBQ2Q7SUFFQSxPQUFPO1FBQ0xTLFNBQVNWLE9BQU9FLE1BQU0sS0FBSztRQUMzQkY7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY3J1bWJsZWQtd2Vic2l0ZS8uL2xpYi9hdXRoLWNvbmZpZy50cz9lZmUzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEF1dGhlbnRpY2F0aW9uIGNvbmZpZ3VyYXRpb24gd2l0aCBzZXBhcmF0ZSBzZWNyZXRzIGZvciBjdXN0b21lciBhbmQgYWRtaW5cclxuZXhwb3J0IGNvbnN0IGF1dGhDb25maWcgPSB7XHJcbiAgLy8gSldUIFNlY3JldHMgLSBNVVNUIGJlIHNldCBpbiBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICBjdXN0b21lckp3dFNlY3JldDogcHJvY2Vzcy5lbnYuQ1VTVE9NRVJfSldUX1NFQ1JFVCxcclxuICBhZG1pbkp3dFNlY3JldDogcHJvY2Vzcy5lbnYuQURNSU5fSldUX1NFQ1JFVCxcclxuICBcclxuICAvLyBGYWxsYmFjayBzZWNyZXRzIChmb3IgZGV2ZWxvcG1lbnQgb25seSlcclxuICBmYWxsYmFja0N1c3RvbWVyU2VjcmV0OiAnY3VzdG9tZXItZGV2LXNlY3JldC1jaGFuZ2UtaW4tcHJvZHVjdGlvbicsXHJcbiAgZmFsbGJhY2tBZG1pblNlY3JldDogJ2FkbWluLWRldi1zZWNyZXQtY2hhbmdlLWluLXByb2R1Y3Rpb24nLFxyXG4gIFxyXG4gIC8vIFRva2VuIGV4cGlyYXRpb24gdGltZXMgKGluIHNlY29uZHMpXHJcbiAgY3VzdG9tZXJUb2tlbkV4cGlyeTogMjQgKiA2MCAqIDYwLCAvLyAyNCBob3Vyc1xyXG4gIGFkbWluVG9rZW5FeHBpcnk6IDcgKiAyNCAqIDYwICogNjAsIC8vIDcgZGF5c1xyXG4gIHJlZnJlc2hUb2tlbkV4cGlyeTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGRheXNcclxuICBcclxuICAvLyBSYXRlIGxpbWl0aW5nXHJcbiAgbWF4TG9naW5BdHRlbXB0czogNSxcclxuICBsb2Nrb3V0RHVyYXRpb246IDE1ICogNjAsIC8vIDE1IG1pbnV0ZXNcclxuICBcclxuICAvLyBQYXNzd29yZCByZXF1aXJlbWVudHNcclxuICBtaW5QYXNzd29yZExlbmd0aDogOCxcclxuICByZXF1aXJlVXBwZXJjYXNlOiB0cnVlLFxyXG4gIHJlcXVpcmVMb3dlcmNhc2U6IHRydWUsXHJcbiAgcmVxdWlyZU51bWJlcnM6IHRydWUsXHJcbiAgcmVxdWlyZVNwZWNpYWxDaGFyczogZmFsc2UsXHJcbiAgXHJcbiAgLy8gU2Vzc2lvbiBtYW5hZ2VtZW50XHJcbiAgc2Vzc2lvblRpbWVvdXQ6IDMwICogNjAsIC8vIDMwIG1pbnV0ZXNcclxuICBtYXhDb25jdXJyZW50U2Vzc2lvbnM6IDMsXHJcbiAgXHJcbiAgLy8gQ29va2llIHNldHRpbmdzXHJcbiAgY29va2llU2V0dGluZ3M6IHtcclxuICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxyXG4gICAgc2FtZVNpdGU6ICdzdHJpY3QnIGFzIGNvbnN0LFxyXG4gICAgcGF0aDogJy8nLFxyXG4gIH1cclxufTtcclxuXHJcbi8vIFZhbGlkYXRlIGVudmlyb25tZW50IHZhcmlhYmxlc1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVBdXRoQ29uZmlnKCkge1xyXG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcclxuICBcclxuICBpZiAoIWF1dGhDb25maWcuY3VzdG9tZXJKd3RTZWNyZXQgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgZXJyb3JzLnB1c2goJ0NVU1RPTUVSX0pXVF9TRUNSRVQgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgcmVxdWlyZWQgaW4gcHJvZHVjdGlvbicpO1xyXG4gIH1cclxuICBcclxuICBpZiAoIWF1dGhDb25maWcuYWRtaW5Kd3RTZWNyZXQgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgZXJyb3JzLnB1c2goJ0FETUlOX0pXVF9TRUNSRVQgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgcmVxdWlyZWQgaW4gcHJvZHVjdGlvbicpO1xyXG4gIH1cclxuICBcclxuICBpZiAoZXJyb3JzLmxlbmd0aCA+IDApIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihgQXV0aGVudGljYXRpb24gY29uZmlndXJhdGlvbiBlcnJvcnM6XFxuJHtlcnJvcnMuam9pbignXFxuJyl9YCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBHZXQgSldUIHNlY3JldCBiYXNlZCBvbiB1c2VyIHR5cGVcclxuZXhwb3J0IGZ1bmN0aW9uIGdldEp3dFNlY3JldCh1c2VyVHlwZTogJ2N1c3RvbWVyJyB8ICdhZG1pbicpOiBzdHJpbmcge1xyXG4gIGlmICh1c2VyVHlwZSA9PT0gJ2N1c3RvbWVyJykge1xyXG4gICAgcmV0dXJuIGF1dGhDb25maWcuY3VzdG9tZXJKd3RTZWNyZXQgfHwgYXV0aENvbmZpZy5mYWxsYmFja0N1c3RvbWVyU2VjcmV0O1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gYXV0aENvbmZpZy5hZG1pbkp3dFNlY3JldCB8fCBhdXRoQ29uZmlnLmZhbGxiYWNrQWRtaW5TZWNyZXQ7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBQYXNzd29yZCB2YWxpZGF0aW9uXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiB7IGlzVmFsaWQ6IGJvb2xlYW47IGVycm9yczogc3RyaW5nW10gfSB7XHJcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xyXG4gIFxyXG4gIGlmIChwYXNzd29yZC5sZW5ndGggPCBhdXRoQ29uZmlnLm1pblBhc3N3b3JkTGVuZ3RoKSB7XHJcbiAgICBlcnJvcnMucHVzaChgUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCAke2F1dGhDb25maWcubWluUGFzc3dvcmRMZW5ndGh9IGNoYXJhY3RlcnMgbG9uZ2ApO1xyXG4gIH1cclxuICBcclxuICBpZiAoYXV0aENvbmZpZy5yZXF1aXJlVXBwZXJjYXNlICYmICEvW0EtWl0vLnRlc3QocGFzc3dvcmQpKSB7XHJcbiAgICBlcnJvcnMucHVzaCgnUGFzc3dvcmQgbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSB1cHBlcmNhc2UgbGV0dGVyJyk7XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChhdXRoQ29uZmlnLnJlcXVpcmVMb3dlcmNhc2UgJiYgIS9bYS16XS8udGVzdChwYXNzd29yZCkpIHtcclxuICAgIGVycm9ycy5wdXNoKCdQYXNzd29yZCBtdXN0IGNvbnRhaW4gYXQgbGVhc3Qgb25lIGxvd2VyY2FzZSBsZXR0ZXInKTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKGF1dGhDb25maWcucmVxdWlyZU51bWJlcnMgJiYgIS9cXGQvLnRlc3QocGFzc3dvcmQpKSB7XHJcbiAgICBlcnJvcnMucHVzaCgnUGFzc3dvcmQgbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSBudW1iZXInKTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKGF1dGhDb25maWcucmVxdWlyZVNwZWNpYWxDaGFycyAmJiAhL1shQCMkJV4mKigpLC4/XCI6e318PD5dLy50ZXN0KHBhc3N3b3JkKSkge1xyXG4gICAgZXJyb3JzLnB1c2goJ1Bhc3N3b3JkIG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgc3BlY2lhbCBjaGFyYWN0ZXInKTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHtcclxuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXHJcbiAgICBlcnJvcnNcclxuICB9O1xyXG59ICJdLCJuYW1lcyI6WyJhdXRoQ29uZmlnIiwiY3VzdG9tZXJKd3RTZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiQ1VTVE9NRVJfSldUX1NFQ1JFVCIsImFkbWluSnd0U2VjcmV0IiwiQURNSU5fSldUX1NFQ1JFVCIsImZhbGxiYWNrQ3VzdG9tZXJTZWNyZXQiLCJmYWxsYmFja0FkbWluU2VjcmV0IiwiY3VzdG9tZXJUb2tlbkV4cGlyeSIsImFkbWluVG9rZW5FeHBpcnkiLCJyZWZyZXNoVG9rZW5FeHBpcnkiLCJtYXhMb2dpbkF0dGVtcHRzIiwibG9ja291dER1cmF0aW9uIiwibWluUGFzc3dvcmRMZW5ndGgiLCJyZXF1aXJlVXBwZXJjYXNlIiwicmVxdWlyZUxvd2VyY2FzZSIsInJlcXVpcmVOdW1iZXJzIiwicmVxdWlyZVNwZWNpYWxDaGFycyIsInNlc3Npb25UaW1lb3V0IiwibWF4Q29uY3VycmVudFNlc3Npb25zIiwiY29va2llU2V0dGluZ3MiLCJodHRwT25seSIsInNlY3VyZSIsInNhbWVTaXRlIiwicGF0aCIsInZhbGlkYXRlQXV0aENvbmZpZyIsImVycm9ycyIsInB1c2giLCJsZW5ndGgiLCJFcnJvciIsImpvaW4iLCJnZXRKd3RTZWNyZXQiLCJ1c2VyVHlwZSIsInZhbGlkYXRlUGFzc3dvcmQiLCJwYXNzd29yZCIsInRlc3QiLCJpc1ZhbGlkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth-config.ts\n");

/***/ }),

/***/ "(rsc)/./lib/middleware/auth.ts":
/*!********************************!*\
  !*** ./lib/middleware/auth.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminAuth: () => (/* binding */ adminAuth),\n/* harmony export */   customerAuth: () => (/* binding */ customerAuth),\n/* harmony export */   generateRefreshToken: () => (/* binding */ generateRefreshToken),\n/* harmony export */   generateSessionId: () => (/* binding */ generateSessionId),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   verifyJWT: () => (/* binding */ verifyJWT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth-config */ \"(rsc)/./lib/auth-config.ts\");\n\n\n\n// Generate JWT token with separate secrets\nfunction generateToken(payload) {\n    const header = {\n        alg: \"HS256\",\n        typ: \"JWT\"\n    };\n    const now = Math.floor(Date.now() / 1000);\n    const expiry = payload.type === \"refresh\" ? now + _lib_auth_config__WEBPACK_IMPORTED_MODULE_2__.authConfig.refreshTokenExpiry : payload.type === \"admin\" ? now + _lib_auth_config__WEBPACK_IMPORTED_MODULE_2__.authConfig.adminTokenExpiry : now + _lib_auth_config__WEBPACK_IMPORTED_MODULE_2__.authConfig.customerTokenExpiry;\n    const finalPayload = {\n        ...payload,\n        iat: now,\n        exp: expiry\n    };\n    const encodedHeader = Buffer.from(JSON.stringify(header)).toString(\"base64url\");\n    const encodedPayload = Buffer.from(JSON.stringify(finalPayload)).toString(\"base64url\");\n    const secret = (0,_lib_auth_config__WEBPACK_IMPORTED_MODULE_2__.getJwtSecret)(payload.type === \"admin\" ? \"admin\" : \"customer\");\n    const signature = (0,crypto__WEBPACK_IMPORTED_MODULE_1__.createHmac)(\"sha256\", secret).update(`${encodedHeader}.${encodedPayload}`).digest(\"base64url\");\n    return `${encodedHeader}.${encodedPayload}.${signature}`;\n}\n// Generate refresh token\nfunction generateRefreshToken(userId, userType, sessionId) {\n    return generateToken({\n        type: \"refresh\",\n        userId,\n        userType,\n        sessionId\n    });\n}\n// Verify JWT token\nfunction verifyJWT(token, expectedType) {\n    const [encodedHeader, encodedPayload, signature] = token.split(\".\");\n    if (!encodedHeader || !encodedPayload || !signature) {\n        throw new Error(\"Invalid token format\");\n    }\n    const payload = JSON.parse(Buffer.from(encodedPayload, \"base64url\").toString());\n    // Determine secret based on payload type\n    const secret = (0,_lib_auth_config__WEBPACK_IMPORTED_MODULE_2__.getJwtSecret)(payload.type === \"admin\" ? \"admin\" : \"customer\");\n    const expectedSignature = (0,crypto__WEBPACK_IMPORTED_MODULE_1__.createHmac)(\"sha256\", secret).update(`${encodedHeader}.${encodedPayload}`).digest(\"base64url\");\n    if (signature !== expectedSignature) {\n        throw new Error(\"Invalid token signature\");\n    }\n    if (payload.exp < Math.floor(Date.now() / 1000)) {\n        throw new Error(\"Token has expired\");\n    }\n    // Verify expected type if provided\n    if (expectedType && payload.type !== expectedType) {\n        throw new Error(`Expected token type ${expectedType}, got ${payload.type}`);\n    }\n    return payload;\n}\n// Generate session ID\nfunction generateSessionId() {\n    return (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomBytes)(32).toString(\"hex\");\n}\n// Middleware for admin-only routes\nasync function adminAuth(req) {\n    try {\n        const authHeader = req.headers.get(\"Authorization\");\n        if (!authHeader?.startsWith(\"Bearer \")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing or invalid authorization header\"\n            }, {\n                status: 401\n            });\n        }\n        const token = authHeader.split(\" \")[1];\n        const payload = verifyJWT(token, \"admin\");\n        // Add the admin info to the request for use in the route handler\n        req.headers.set(\"x-admin-username\", payload.username);\n        req.headers.set(\"x-admin-email\", payload.email);\n        req.headers.set(\"x-session-id\", payload.sessionId);\n        return null; // Continue to the route handler\n    } catch (error) {\n        console.error(\"Admin auth error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Invalid or expired token\"\n        }, {\n            status: 401\n        });\n    }\n}\n// Middleware for customer-only routes\nasync function customerAuth(req) {\n    try {\n        const authHeader = req.headers.get(\"Authorization\");\n        if (!authHeader?.startsWith(\"Bearer \")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing or invalid authorization header\"\n            }, {\n                status: 401\n            });\n        }\n        const token = authHeader.split(\" \")[1];\n        const payload = verifyJWT(token, \"customer\");\n        // Add the customer info to the request for use in the route handler\n        req.headers.set(\"x-customer-id\", payload.id.toString());\n        req.headers.set(\"x-customer-email\", payload.email);\n        req.headers.set(\"x-session-id\", payload.sessionId);\n        return null; // Continue to the route handler\n    } catch (error) {\n        console.error(\"Customer auth error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Invalid or expired token\"\n        }, {\n            status: 401\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPO1FBRWpDLG9FQUFvRTtRQUNwRVEsSUFBSUUsT0FBTyxDQUFDTSxHQUFHLENBQUMsaUJBQWlCaEQsUUFBUXNELEVBQUUsQ0FBQ2pDLFFBQVE7UUFDcERtQixJQUFJRSxPQUFPLENBQUNNLEdBQUcsQ0FBQyxvQkFBb0JoRCxRQUFRa0QsS0FBSztRQUNqRFYsSUFBSUUsT0FBTyxDQUFDTSxHQUFHLENBQUMsZ0JBQWdCaEQsUUFBUThCLFNBQVM7UUFFakQsT0FBTyxNQUFNLGdDQUFnQztJQUMvQyxFQUFFLE9BQU9nQixPQUFPO1FBQ2RLLFFBQVFMLEtBQUssQ0FBQyx3QkFBd0JBO1FBQ3RDLE9BQU9wRCxxREFBWUEsQ0FBQ21ELElBQUksQ0FDdEI7WUFBRUMsT0FBT0EsaUJBQWlCWCxRQUFRVyxNQUFNTSxPQUFPLEdBQUc7UUFBMkIsR0FDN0U7WUFBRUwsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jcnVtYmxlZC13ZWJzaXRlLy4vbGliL21pZGRsZXdhcmUvYXV0aC50cz8yODNlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBjcmVhdGVIbWFjLCByYW5kb21CeXRlcyB9IGZyb20gJ2NyeXB0byc7XG5pbXBvcnQgeyBnZXRKd3RTZWNyZXQsIGF1dGhDb25maWcgfSBmcm9tICdAL2xpYi9hdXRoLWNvbmZpZyc7XG5cbi8vIFR5cGVzIGZvciBKV1QgcGF5bG9hZFxuaW50ZXJmYWNlIEFkbWluUGF5bG9hZCB7XG4gIHR5cGU6ICdhZG1pbic7XG4gIHVzZXJuYW1lOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHNlc3Npb25JZDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgQ3VzdG9tZXJQYXlsb2FkIHtcbiAgdHlwZTogJ2N1c3RvbWVyJztcbiAgaWQ6IG51bWJlcjtcbiAgZW1haWw6IHN0cmluZztcbiAgc2Vzc2lvbklkOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBSZWZyZXNoUGF5bG9hZCB7XG4gIHR5cGU6ICdyZWZyZXNoJztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHVzZXJUeXBlOiAnY3VzdG9tZXInIHwgJ2FkbWluJztcbiAgc2Vzc2lvbklkOiBzdHJpbmc7XG59XG5cbnR5cGUgSldUUGF5bG9hZCA9IEFkbWluUGF5bG9hZCB8IEN1c3RvbWVyUGF5bG9hZCB8IFJlZnJlc2hQYXlsb2FkO1xuXG4vLyBHZW5lcmF0ZSBKV1QgdG9rZW4gd2l0aCBzZXBhcmF0ZSBzZWNyZXRzXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVUb2tlbihwYXlsb2FkOiBKV1RQYXlsb2FkKTogc3RyaW5nIHtcbiAgY29uc3QgaGVhZGVyID0ge1xuICAgIGFsZzogJ0hTMjU2JyxcbiAgICB0eXA6ICdKV1QnXG4gIH07XG5cbiAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XG4gIGNvbnN0IGV4cGlyeSA9IHBheWxvYWQudHlwZSA9PT0gJ3JlZnJlc2gnIFxuICAgID8gbm93ICsgYXV0aENvbmZpZy5yZWZyZXNoVG9rZW5FeHBpcnlcbiAgICA6IHBheWxvYWQudHlwZSA9PT0gJ2FkbWluJyBcbiAgICAgID8gbm93ICsgYXV0aENvbmZpZy5hZG1pblRva2VuRXhwaXJ5IFxuICAgICAgOiBub3cgKyBhdXRoQ29uZmlnLmN1c3RvbWVyVG9rZW5FeHBpcnk7XG5cbiAgY29uc3QgZmluYWxQYXlsb2FkID0ge1xuICAgIC4uLnBheWxvYWQsXG4gICAgaWF0OiBub3csXG4gICAgZXhwOiBleHBpcnlcbiAgfTtcblxuICBjb25zdCBlbmNvZGVkSGVhZGVyID0gQnVmZmVyLmZyb20oSlNPTi5zdHJpbmdpZnkoaGVhZGVyKSkudG9TdHJpbmcoJ2Jhc2U2NHVybCcpO1xuICBjb25zdCBlbmNvZGVkUGF5bG9hZCA9IEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KGZpbmFsUGF5bG9hZCkpLnRvU3RyaW5nKCdiYXNlNjR1cmwnKTtcblxuICBjb25zdCBzZWNyZXQgPSBnZXRKd3RTZWNyZXQocGF5bG9hZC50eXBlID09PSAnYWRtaW4nID8gJ2FkbWluJyA6ICdjdXN0b21lcicpO1xuICBjb25zdCBzaWduYXR1cmUgPSBjcmVhdGVIbWFjKCdzaGEyNTYnLCBzZWNyZXQpXG4gICAgLnVwZGF0ZShgJHtlbmNvZGVkSGVhZGVyfS4ke2VuY29kZWRQYXlsb2FkfWApXG4gICAgLmRpZ2VzdCgnYmFzZTY0dXJsJyk7XG5cbiAgcmV0dXJuIGAke2VuY29kZWRIZWFkZXJ9LiR7ZW5jb2RlZFBheWxvYWR9LiR7c2lnbmF0dXJlfWA7XG59XG5cbi8vIEdlbmVyYXRlIHJlZnJlc2ggdG9rZW5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVJlZnJlc2hUb2tlbih1c2VySWQ6IHN0cmluZywgdXNlclR5cGU6ICdjdXN0b21lcicgfCAnYWRtaW4nLCBzZXNzaW9uSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBnZW5lcmF0ZVRva2VuKHtcbiAgICB0eXBlOiAncmVmcmVzaCcsXG4gICAgdXNlcklkLFxuICAgIHVzZXJUeXBlLFxuICAgIHNlc3Npb25JZFxuICB9KTtcbn1cblxuLy8gVmVyaWZ5IEpXVCB0b2tlblxuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeUpXVCh0b2tlbjogc3RyaW5nLCBleHBlY3RlZFR5cGU/OiAnY3VzdG9tZXInIHwgJ2FkbWluJyB8ICdyZWZyZXNoJyk6IEpXVFBheWxvYWQge1xuICBjb25zdCBbZW5jb2RlZEhlYWRlciwgZW5jb2RlZFBheWxvYWQsIHNpZ25hdHVyZV0gPSB0b2tlbi5zcGxpdCgnLicpO1xuXG4gIGlmICghZW5jb2RlZEhlYWRlciB8fCAhZW5jb2RlZFBheWxvYWQgfHwgIXNpZ25hdHVyZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0b2tlbiBmb3JtYXQnKTtcbiAgfVxuXG4gIGNvbnN0IHBheWxvYWQgPSBKU09OLnBhcnNlKEJ1ZmZlci5mcm9tKGVuY29kZWRQYXlsb2FkLCAnYmFzZTY0dXJsJykudG9TdHJpbmcoKSk7XG4gIFxuICAvLyBEZXRlcm1pbmUgc2VjcmV0IGJhc2VkIG9uIHBheWxvYWQgdHlwZVxuICBjb25zdCBzZWNyZXQgPSBnZXRKd3RTZWNyZXQocGF5bG9hZC50eXBlID09PSAnYWRtaW4nID8gJ2FkbWluJyA6ICdjdXN0b21lcicpO1xuICBcbiAgY29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBjcmVhdGVIbWFjKCdzaGEyNTYnLCBzZWNyZXQpXG4gICAgLnVwZGF0ZShgJHtlbmNvZGVkSGVhZGVyfS4ke2VuY29kZWRQYXlsb2FkfWApXG4gICAgLmRpZ2VzdCgnYmFzZTY0dXJsJyk7XG5cbiAgaWYgKHNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdG9rZW4gc2lnbmF0dXJlJyk7XG4gIH1cblxuICBpZiAocGF5bG9hZC5leHAgPCBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignVG9rZW4gaGFzIGV4cGlyZWQnKTtcbiAgfVxuXG4gIC8vIFZlcmlmeSBleHBlY3RlZCB0eXBlIGlmIHByb3ZpZGVkXG4gIGlmIChleHBlY3RlZFR5cGUgJiYgcGF5bG9hZC50eXBlICE9PSBleHBlY3RlZFR5cGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIHRva2VuIHR5cGUgJHtleHBlY3RlZFR5cGV9LCBnb3QgJHtwYXlsb2FkLnR5cGV9YCk7XG4gIH1cblxuICByZXR1cm4gcGF5bG9hZDtcbn1cblxuLy8gR2VuZXJhdGUgc2Vzc2lvbiBJRFxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlU2Vzc2lvbklkKCk6IHN0cmluZyB7XG4gIHJldHVybiByYW5kb21CeXRlcygzMikudG9TdHJpbmcoJ2hleCcpO1xufVxuXG4vLyBNaWRkbGV3YXJlIGZvciBhZG1pbi1vbmx5IHJvdXRlc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkbWluQXV0aChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmdldCgnQXV0aG9yaXphdGlvbicpO1xuICAgIGlmICghYXV0aEhlYWRlcj8uc3RhcnRzV2l0aCgnQmVhcmVyICcpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdNaXNzaW5nIG9yIGludmFsaWQgYXV0aG9yaXphdGlvbiBoZWFkZXInIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXTtcbiAgICBjb25zdCBwYXlsb2FkID0gdmVyaWZ5SldUKHRva2VuLCAnYWRtaW4nKSBhcyBBZG1pblBheWxvYWQ7XG5cbiAgICAvLyBBZGQgdGhlIGFkbWluIGluZm8gdG8gdGhlIHJlcXVlc3QgZm9yIHVzZSBpbiB0aGUgcm91dGUgaGFuZGxlclxuICAgIHJlcS5oZWFkZXJzLnNldCgneC1hZG1pbi11c2VybmFtZScsIHBheWxvYWQudXNlcm5hbWUpO1xuICAgIHJlcS5oZWFkZXJzLnNldCgneC1hZG1pbi1lbWFpbCcsIHBheWxvYWQuZW1haWwpO1xuICAgIHJlcS5oZWFkZXJzLnNldCgneC1zZXNzaW9uLWlkJywgcGF5bG9hZC5zZXNzaW9uSWQpO1xuXG4gICAgcmV0dXJuIG51bGw7IC8vIENvbnRpbnVlIHRvIHRoZSByb3V0ZSBoYW5kbGVyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQWRtaW4gYXV0aCBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnSW52YWxpZCBvciBleHBpcmVkIHRva2VuJyB9LFxuICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgKTtcbiAgfVxufVxuXG4vLyBNaWRkbGV3YXJlIGZvciBjdXN0b21lci1vbmx5IHJvdXRlc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGN1c3RvbWVyQXV0aChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmdldCgnQXV0aG9yaXphdGlvbicpO1xuICAgIGlmICghYXV0aEhlYWRlcj8uc3RhcnRzV2l0aCgnQmVhcmVyICcpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdNaXNzaW5nIG9yIGludmFsaWQgYXV0aG9yaXphdGlvbiBoZWFkZXInIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXTtcbiAgICBjb25zdCBwYXlsb2FkID0gdmVyaWZ5SldUKHRva2VuLCAnY3VzdG9tZXInKSBhcyBDdXN0b21lclBheWxvYWQ7XG5cbiAgICAvLyBBZGQgdGhlIGN1c3RvbWVyIGluZm8gdG8gdGhlIHJlcXVlc3QgZm9yIHVzZSBpbiB0aGUgcm91dGUgaGFuZGxlclxuICAgIHJlcS5oZWFkZXJzLnNldCgneC1jdXN0b21lci1pZCcsIHBheWxvYWQuaWQudG9TdHJpbmcoKSk7XG4gICAgcmVxLmhlYWRlcnMuc2V0KCd4LWN1c3RvbWVyLWVtYWlsJywgcGF5bG9hZC5lbWFpbCk7XG4gICAgcmVxLmhlYWRlcnMuc2V0KCd4LXNlc3Npb24taWQnLCBwYXlsb2FkLnNlc3Npb25JZCk7XG5cbiAgICByZXR1cm4gbnVsbDsgLy8gQ29udGludWUgdG8gdGhlIHJvdXRlIGhhbmRsZXJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdDdXN0b21lciBhdXRoIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4nIH0sXG4gICAgICB7IHN0YXR1czogNDAxIH1cbiAgICApO1xuICB9XG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjcmVhdGVIbWFjIiwicmFuZG9tQnl0ZXMiLCJnZXRKd3RTZWNyZXQiLCJhdXRoQ29uZmlnIiwiZ2VuZXJhdGVUb2tlbiIsInBheWxvYWQiLCJoZWFkZXIiLCJhbGciLCJ0eXAiLCJub3ciLCJNYXRoIiwiZmxvb3IiLCJEYXRlIiwiZXhwaXJ5IiwidHlwZSIsInJlZnJlc2hUb2tlbkV4cGlyeSIsImFkbWluVG9rZW5FeHBpcnkiLCJjdXN0b21lclRva2VuRXhwaXJ5IiwiZmluYWxQYXlsb2FkIiwiaWF0IiwiZXhwIiwiZW5jb2RlZEhlYWRlciIsIkJ1ZmZlciIsImZyb20iLCJKU09OIiwic3RyaW5naWZ5IiwidG9TdHJpbmciLCJlbmNvZGVkUGF5bG9hZCIsInNlY3JldCIsInNpZ25hdHVyZSIsInVwZGF0ZSIsImRpZ2VzdCIsImdlbmVyYXRlUmVmcmVzaFRva2VuIiwidXNlcklkIiwidXNlclR5cGUiLCJzZXNzaW9uSWQiLCJ2ZXJpZnlKV1QiLCJ0b2tlbiIsImV4cGVjdGVkVHlwZSIsInNwbGl0IiwiRXJyb3IiLCJwYXJzZSIsImV4cGVjdGVkU2lnbmF0dXJlIiwiZ2VuZXJhdGVTZXNzaW9uSWQiLCJhZG1pbkF1dGgiLCJyZXEiLCJhdXRoSGVhZGVyIiwiaGVhZGVycyIsImdldCIsInN0YXJ0c1dpdGgiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJzZXQiLCJ1c2VybmFtZSIsImVtYWlsIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJjdXN0b21lckF1dGgiLCJpZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/middleware/auth.ts\n");

/***/ })

};
;