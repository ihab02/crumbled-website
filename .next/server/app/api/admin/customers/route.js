(()=>{var e={};e.id=5436,e.ids=[5436,5866],e.modules={62849:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=62849,e.exports=r},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},98216:e=>{"use strict";e.exports=require("net")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},53110:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>w,patchFetch:()=>E,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{GET:()=>d,dynamic:()=>l});var a=t(49303),o=t(88716),n=t(60670),i=t(87070),c=t(22439),u=t(80087);let l="force-dynamic",m=c.databaseService;async function d(e){try{var r;let t=e.cookies.get("adminToken")?.value;if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let s=await (0,u.verifyJWT)(t);if(!s||"admin"!==s.type)return i.NextResponse.json({error:"Unauthorized"},{status:401});let a=(r=await m.query(`SELECT 
        id,
        first_name,
        last_name,
        email,
        phone,
        mobile,
        mobile_verified,
        email_verified,
        type,
        is_active,
        created_at,
        updated_at
       FROM customers 
       ORDER BY created_at DESC`),Array.isArray(r)?r:r&&"object"==typeof r&&void 0!==r.length?Array.from(r):r?[r]:[]).map(e=>({...e,name:`${e.first_name||""} ${e.last_name||""}`.trim()||"Unknown Customer"}));return i.NextResponse.json({success:!0,data:a})}catch(e){return console.error("Error fetching customers:",e),i.NextResponse.json({error:"Failed to fetch customers"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/customers/route",pathname:"/api/admin/customers",filename:"route",bundlePath:"app/api/admin/customers/route"},resolvedPagePath:"C:\\Users\\ASUS\\AngularWebApp\\crumbled-website\\app\\api\\admin\\customers\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:y}=p,w="/api/admin/customers/route";function E(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}},60391:(e,r,t)=>{"use strict";t.d(r,{Po:()=>o,aH:()=>s,cy:()=>a,uo:()=>n});let s={customerJwtSecret:process.env.CUSTOMER_JWT_SECRET,adminJwtSecret:process.env.ADMIN_JWT_SECRET,fallbackCustomerSecret:"customer-dev-secret-change-in-production",fallbackAdminSecret:"admin-dev-secret-change-in-production",customerTokenExpiry:86400,adminTokenExpiry:604800,refreshTokenExpiry:2592e3,maxLoginAttempts:5,lockoutDuration:900,minPasswordLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!1,sessionTimeout:1800,maxConcurrentSessions:3,cookieSettings:{httpOnly:!0,secure:!0,sameSite:"strict",path:"/"}};function a(){let e=[];if(s.customerJwtSecret||e.push("CUSTOMER_JWT_SECRET environment variable is required in production"),s.adminJwtSecret||e.push("ADMIN_JWT_SECRET environment variable is required in production"),e.length>0)throw Error(`Authentication configuration errors:
${e.join("\n")}`)}function o(e){return"customer"===e?s.customerJwtSecret||s.fallbackCustomerSecret:s.adminJwtSecret||s.fallbackAdminSecret}function n(e){let r=[];return e.length<s.minPasswordLength&&r.push(`Password must be at least ${s.minPasswordLength} characters long`),s.requireUppercase&&!/[A-Z]/.test(e)&&r.push("Password must contain at least one uppercase letter"),s.requireLowercase&&!/[a-z]/.test(e)&&r.push("Password must contain at least one lowercase letter"),s.requireNumbers&&!/\d/.test(e)&&r.push("Password must contain at least one number"),s.requireSpecialChars&&!/[!@#$%^&*(),.?":{}|<>]/.test(e)&&r.push("Password must contain at least one special character"),{isValid:0===r.length,errors:r}}},9487:(e,r,t)=>{"use strict";t.d(r,{M7:()=>a,ZP:()=>n,Zh:()=>o});let s=t(73785).createPool({host:process.env.DB_HOST||"localhost",user:process.env.DB_USER||"root",password:process.env.DB_PASSWORD||"Goodmorning@1",database:process.env.DB_NAME||"crumbled_nextDB",waitForConnections:!0,connectionLimit:10,queueLimit:0,enableKeepAlive:!0,keepAliveInitialDelay:1e4,idleTimeout:6e4,maxIdle:5});async function a(){let e;try{e=await s.getConnection();let[r]=await e.query("SELECT NOW() as `current_time`, VERSION() as mysql_version");return{success:!0,message:"Database connected successfully",timestamp:r[0].current_time,version:r[0].mysql_version}}catch(e){return console.error("Database connection failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown connection error"}}finally{e&&e.release()}}async function o(e,r){let t;try{t=await s.getConnection();let[a]=await t.query("SELECT * FROM orders WHERE tracking_id = ? AND customer_email = ?",[e,r]);if(0===a.length)return{success:!1,error:"Order not found or email doesn't match"};let[o]=await t.query("SELECT * FROM order_items WHERE order_id = ?",[a[0].id]);return{success:!0,order:a[0],items:o}}catch(e){return console.error("Error fetching order by tracking:",e),{success:!1,error:e instanceof Error?e.message:"Database operation failed"}}finally{t&&t.release()}}let n=s},80087:(e,r,t)=>{"use strict";t.d(r,{RA:()=>o,bw:()=>n,verifyJWT:()=>i,xv:()=>c}),t(87070);var s=t(84770),a=t(60391);function o(e){let r=Math.floor(Date.now()/1e3),t="refresh"===e.type?r+a.aH.refreshTokenExpiry:"admin"===e.type?r+a.aH.adminTokenExpiry:r+a.aH.customerTokenExpiry,o={...e,iat:r,exp:t},n=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),i=Buffer.from(JSON.stringify(o)).toString("base64url"),c=(0,a.Po)("admin"===e.type?"admin":"customer"),u=(0,s.createHmac)("sha256",c).update(`${n}.${i}`).digest("base64url");return`${n}.${i}.${u}`}function n(e,r,t){return o({type:"refresh",userId:e,userType:r,sessionId:t})}function i(e,r){let[t,o,n]=e.split(".");if(!t||!o||!n)throw Error("Invalid token format");let i=JSON.parse(Buffer.from(o,"base64url").toString()),c=(0,a.Po)("admin"===i.type?"admin":"customer");if(n!==(0,s.createHmac)("sha256",c).update(`${t}.${o}`).digest("base64url"))throw Error("Invalid token signature");if(i.exp<Math.floor(Date.now()/1e3))throw Error("Token has expired");if(r&&i.type!==r)throw Error(`Expected token type ${r}, got ${i.type}`);return i}function c(){return(0,s.randomBytes)(32).toString("hex")}},22439:(e,r,t)=>{"use strict";t.d(r,{databaseService:()=>a});var s=t(9487);let a={async query(e,r){let t;try{t=await s.ZP.getConnection();let[a]=await t.execute(e,r);return a}catch(e){throw console.error("Database query error:",e),e}finally{t&&t.release()}},async transaction(e){let r=await s.ZP.getConnection();try{await r.beginTransaction();let t=await e(r);return await r.commit(),t}catch(e){throw await r.rollback(),e}finally{r.release()}},async testConnection(){let e;try{e=await s.ZP.getConnection();let[r]=await e.query("SELECT NOW() as `current_time`, VERSION() as mysql_version");return{success:!0,data:r[0]}}catch(e){return console.error("Database connection test failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}finally{e&&e.release()}}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,3785],()=>t(53110));module.exports=s})();