(()=>{var e={};e.id=5436,e.ids=[5436,5866],e.modules={62849:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=62849,e.exports=r},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},98216:e=>{"use strict";e.exports=require("net")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},53110:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>E,patchFetch:()=>y,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{GET:()=>m});var o=t(49303),n=t(88716),a=t(60670),i=t(87070),c=t(22439),u=t(80087);let l=c.databaseService;async function m(e){try{var r;let t=e.cookies.get("adminToken")?.value;if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let s=await (0,u.verifyJWT)(t);if(!s||"admin"!==s.type)return i.NextResponse.json({error:"Unauthorized"},{status:401});let o=(r=await l.query(`SELECT 
        id,
        first_name,
        last_name,
        email,
        phone,
        mobile,
        mobile_verified,
        email_verified,
        type,
        is_active,
        created_at,
        updated_at
       FROM customers 
       ORDER BY created_at DESC`),Array.isArray(r)?r:r&&"object"==typeof r&&void 0!==r.length?Array.from(r):r?[r]:[]).map(e=>({...e,name:`${e.first_name||""} ${e.last_name||""}`.trim()||"Unknown Customer"}));return i.NextResponse.json({success:!0,data:o})}catch(e){return console.error("Error fetching customers:",e),i.NextResponse.json({error:"Failed to fetch customers"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/customers/route",pathname:"/api/admin/customers",filename:"route",bundlePath:"app/api/admin/customers/route"},resolvedPagePath:"C:\\Users\\ASUS\\AngularWebApp\\crumbled-website\\app\\api\\admin\\customers\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:f,serverHooks:h}=d,E="/api/admin/customers/route";function y(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},60391:(e,r,t)=>{"use strict";t.d(r,{Po:()=>a,aH:()=>s,cy:()=>n,uo:()=>i});let s={customerJwtSecret:process.env.CUSTOMER_JWT_SECRET,adminJwtSecret:process.env.ADMIN_JWT_SECRET,fallbackCustomerSecret:"customer-dev-secret-change-in-production",fallbackAdminSecret:"admin-dev-secret-change-in-production",customerTokenExpiry:86400,adminTokenExpiry:604800,refreshTokenExpiry:2592e3,maxLoginAttempts:5,lockoutDuration:900,minPasswordLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!1,sessionTimeout:1800,maxConcurrentSessions:3,cookieSettings:{httpOnly:!0,secure:!0,sameSite:"strict",path:"/"}},o=!1;function n(){let e=[];return(o||(console.log("\uD83D\uDD0D [DEBUG] Environment variables check:"),console.log("\uD83D\uDD0D [DEBUG] NODE_ENV:","production"),console.log("\uD83D\uDD0D [DEBUG] CUSTOMER_JWT_SECRET exists:",!!process.env.CUSTOMER_JWT_SECRET),console.log("\uD83D\uDD0D [DEBUG] ADMIN_JWT_SECRET exists:",!!process.env.ADMIN_JWT_SECRET),console.log("\uD83D\uDD0D [DEBUG] authConfig.customerJwtSecret:",!!s.customerJwtSecret),console.log("\uD83D\uDD0D [DEBUG] authConfig.adminJwtSecret:",!!s.adminJwtSecret),o=!0),s.customerJwtSecret||e.push("CUSTOMER_JWT_SECRET environment variable is required in production"),s.adminJwtSecret||e.push("ADMIN_JWT_SECRET environment variable is required in production"),e.length>0)?(o||(console.error("⚠️ [WARNING] Authentication configuration errors:",e),console.warn("⚠️ [WARNING] Using fallback secrets in production - this is not secure!")),!1):(o||console.log("✅ [DEBUG] Authentication configuration is valid"),!0)}function a(e){return"customer"===e?s.customerJwtSecret||s.fallbackCustomerSecret:s.adminJwtSecret||s.fallbackAdminSecret}function i(e){let r=[];return e.length<s.minPasswordLength&&r.push(`Password must be at least ${s.minPasswordLength} characters long`),s.requireUppercase&&!/[A-Z]/.test(e)&&r.push("Password must contain at least one uppercase letter"),s.requireLowercase&&!/[a-z]/.test(e)&&r.push("Password must contain at least one lowercase letter"),s.requireNumbers&&!/\d/.test(e)&&r.push("Password must contain at least one number"),s.requireSpecialChars&&!/[!@#$%^&*(),.?":{}|<>]/.test(e)&&r.push("Password must contain at least one special character"),{isValid:0===r.length,errors:r}}},9487:(e,r,t)=>{"use strict";t.d(r,{M7:()=>o,ZP:()=>a,Zh:()=>n});let s=t(73785).createPool({host:process.env.DB_HOST||"localhost",user:process.env.DB_USER||"root",password:process.env.DB_PASSWORD||"Goodmorning@1",database:process.env.DB_NAME||"crumbled_nextDB",waitForConnections:!0,connectionLimit:10,queueLimit:0,enableKeepAlive:!0,keepAliveInitialDelay:1e4,idleTimeout:6e4,maxIdle:5});async function o(){let e;try{e=await s.getConnection();let[r]=await e.query("SELECT NOW() as `current_time`, VERSION() as mysql_version");return{success:!0,message:"Database connected successfully",timestamp:r[0].current_time,version:r[0].mysql_version}}catch(e){return console.error("Database connection failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown connection error"}}finally{e&&e.release()}}async function n(e,r){let t;try{t=await s.getConnection();let[o]=await t.query("SELECT * FROM orders WHERE tracking_id = ? AND customer_email = ?",[e,r]);if(0===o.length)return{success:!1,error:"Order not found or email doesn't match"};let[n]=await t.query("SELECT * FROM order_items WHERE order_id = ?",[o[0].id]);return{success:!0,order:o[0],items:n}}catch(e){return console.error("Error fetching order by tracking:",e),{success:!1,error:e instanceof Error?e.message:"Database operation failed"}}finally{t&&t.release()}}let a=s},80087:(e,r,t)=>{"use strict";t.d(r,{RA:()=>n,bw:()=>a,verifyJWT:()=>i,xv:()=>c}),t(87070);var s=t(84770),o=t(60391);function n(e){let r=Math.floor(Date.now()/1e3),t="refresh"===e.type?r+o.aH.refreshTokenExpiry:"admin"===e.type?r+o.aH.adminTokenExpiry:r+o.aH.customerTokenExpiry,n={...e,iat:r,exp:t},a=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),i=Buffer.from(JSON.stringify(n)).toString("base64url"),c=(0,o.Po)("admin"===e.type?"admin":"customer"),u=(0,s.createHmac)("sha256",c).update(`${a}.${i}`).digest("base64url");return`${a}.${i}.${u}`}function a(e,r,t){return n({type:"refresh",userId:e,userType:r,sessionId:t})}function i(e,r){let[t,n,a]=e.split(".");if(!t||!n||!a)throw Error("Invalid token format");let i=JSON.parse(Buffer.from(n,"base64url").toString()),c=(0,o.Po)("admin"===i.type?"admin":"customer");if(a!==(0,s.createHmac)("sha256",c).update(`${t}.${n}`).digest("base64url"))throw Error("Invalid token signature");if(i.exp<Math.floor(Date.now()/1e3))throw Error("Token has expired");if(r&&i.type!==r)throw Error(`Expected token type ${r}, got ${i.type}`);return i}function c(){return(0,s.randomBytes)(32).toString("hex")}},22439:(e,r,t)=>{"use strict";t.d(r,{databaseService:()=>o});var s=t(9487);let o={async query(e,r){let t;try{t=await s.ZP.getConnection();let[o]=await t.execute(e,r);return o}catch(e){throw console.error("Database query error:",e),e}finally{t&&t.release()}},async transaction(e){let r=await s.ZP.getConnection();try{await r.beginTransaction();let t=await e(r);return await r.commit(),t}catch(e){throw await r.rollback(),e}finally{r.release()}},async testConnection(){let e;try{e=await s.ZP.getConnection();let[r]=await e.query("SELECT NOW() as `current_time`, VERSION() as mysql_version");return{success:!0,data:r[0]}}catch(e){return console.error("Database connection test failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}finally{e&&e.release()}}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,3785],()=>t(53110));module.exports=s})();