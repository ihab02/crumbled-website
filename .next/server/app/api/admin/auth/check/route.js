"use strict";(()=>{var e={};e.id=1954,e.ids=[1954,5866],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},47947:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>S,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>l});var n={};t.r(n),t.d(n,{GET:()=>p,dynamic:()=>c});var a=t(49303),o=t(88716),s=t(60670),i=t(87070),u=t(80087);let c="force-dynamic";async function p(e){try{let r=e.cookies.get("adminToken")?.value;if(!r)return i.NextResponse.json({error:"No token found"},{status:401});let t=await (0,u.verifyJWT)(r);if(!t||"admin"!==t.type)return i.NextResponse.json({error:"Invalid token"},{status:401});return i.NextResponse.json({user:{id:t.id,username:t.username,type:t.type}})}catch(e){return console.error("Auth check error:",e),i.NextResponse.json({error:"Invalid token"},{status:401})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/auth/check/route",pathname:"/api/admin/auth/check",filename:"route",bundlePath:"app/api/admin/auth/check/route"},resolvedPagePath:"C:\\Users\\ASUS\\AngularWebApp\\crumbled-website\\app\\api\\admin\\auth\\check\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:h}=d,f="/api/admin/auth/check/route";function S(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:l})}},60391:(e,r,t)=>{t.d(r,{Po:()=>o,aH:()=>n,cy:()=>a,uo:()=>s});let n={customerJwtSecret:process.env.CUSTOMER_JWT_SECRET,adminJwtSecret:process.env.ADMIN_JWT_SECRET,fallbackCustomerSecret:"customer-dev-secret-change-in-production",fallbackAdminSecret:"admin-dev-secret-change-in-production",customerTokenExpiry:86400,adminTokenExpiry:604800,refreshTokenExpiry:2592e3,maxLoginAttempts:5,lockoutDuration:900,minPasswordLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!1,sessionTimeout:1800,maxConcurrentSessions:3,cookieSettings:{httpOnly:!0,secure:!0,sameSite:"strict",path:"/"}};function a(){let e=[];if(n.customerJwtSecret||e.push("CUSTOMER_JWT_SECRET environment variable is required in production"),n.adminJwtSecret||e.push("ADMIN_JWT_SECRET environment variable is required in production"),e.length>0)throw Error(`Authentication configuration errors:
${e.join("\n")}`)}function o(e){return"customer"===e?n.customerJwtSecret||n.fallbackCustomerSecret:n.adminJwtSecret||n.fallbackAdminSecret}function s(e){let r=[];return e.length<n.minPasswordLength&&r.push(`Password must be at least ${n.minPasswordLength} characters long`),n.requireUppercase&&!/[A-Z]/.test(e)&&r.push("Password must contain at least one uppercase letter"),n.requireLowercase&&!/[a-z]/.test(e)&&r.push("Password must contain at least one lowercase letter"),n.requireNumbers&&!/\d/.test(e)&&r.push("Password must contain at least one number"),n.requireSpecialChars&&!/[!@#$%^&*(),.?":{}|<>]/.test(e)&&r.push("Password must contain at least one special character"),{isValid:0===r.length,errors:r}}},80087:(e,r,t)=>{t.d(r,{RA:()=>o,bw:()=>s,verifyJWT:()=>i,xv:()=>u}),t(87070);var n=t(84770),a=t(60391);function o(e){let r=Math.floor(Date.now()/1e3),t="refresh"===e.type?r+a.aH.refreshTokenExpiry:"admin"===e.type?r+a.aH.adminTokenExpiry:r+a.aH.customerTokenExpiry,o={...e,iat:r,exp:t},s=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),i=Buffer.from(JSON.stringify(o)).toString("base64url"),u=(0,a.Po)("admin"===e.type?"admin":"customer"),c=(0,n.createHmac)("sha256",u).update(`${s}.${i}`).digest("base64url");return`${s}.${i}.${c}`}function s(e,r,t){return o({type:"refresh",userId:e,userType:r,sessionId:t})}function i(e,r){let[t,o,s]=e.split(".");if(!t||!o||!s)throw Error("Invalid token format");let i=JSON.parse(Buffer.from(o,"base64url").toString()),u=(0,a.Po)("admin"===i.type?"admin":"customer");if(s!==(0,n.createHmac)("sha256",u).update(`${t}.${o}`).digest("base64url"))throw Error("Invalid token signature");if(i.exp<Math.floor(Date.now()/1e3))throw Error("Token has expired");if(r&&i.type!==r)throw Error(`Expected token type ${r}, got ${i.type}`);return i}function u(){return(0,n.randomBytes)(32).toString("hex")}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[9276,5972],()=>t(47947));module.exports=n})();