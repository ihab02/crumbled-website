"use strict";(()=>{var e={};e.id=1954,e.ids=[1954,5866],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},47947:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var o={};r.r(o),r.d(o,{GET:()=>c});var n=r(49303),s=r(88716),a=r(60670),i=r(87070),u=r(80087);async function c(e){try{let t=e.cookies.get("adminToken")?.value;if(!t)return i.NextResponse.json({error:"No token found"},{status:401});let r=await (0,u.verifyJWT)(t);if(!r||"admin"!==r.type)return i.NextResponse.json({error:"Invalid token"},{status:401});return i.NextResponse.json({user:{id:r.id,username:r.username,type:r.type}})}catch(e){return console.error("Auth check error:",e),i.NextResponse.json({error:"Invalid token"},{status:401})}}let p=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/admin/auth/check/route",pathname:"/api/admin/auth/check",filename:"route",bundlePath:"app/api/admin/auth/check/route"},resolvedPagePath:"C:\\Users\\ASUS\\AngularWebApp\\crumbled-website\\app\\api\\admin\\auth\\check\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m}=p,h="/api/admin/auth/check/route";function f(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},60391:(e,t,r)=>{r.d(t,{Po:()=>a,aH:()=>o,cy:()=>s,uo:()=>i});let o={customerJwtSecret:process.env.CUSTOMER_JWT_SECRET,adminJwtSecret:process.env.ADMIN_JWT_SECRET,fallbackCustomerSecret:"customer-dev-secret-change-in-production",fallbackAdminSecret:"admin-dev-secret-change-in-production",customerTokenExpiry:86400,adminTokenExpiry:604800,refreshTokenExpiry:2592e3,maxLoginAttempts:5,lockoutDuration:900,minPasswordLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!1,sessionTimeout:1800,maxConcurrentSessions:3,cookieSettings:{httpOnly:!0,secure:!0,sameSite:"strict",path:"/"}},n=!1;function s(){let e=[];return(n||(console.log("\uD83D\uDD0D [DEBUG] Environment variables check:"),console.log("\uD83D\uDD0D [DEBUG] NODE_ENV:","production"),console.log("\uD83D\uDD0D [DEBUG] CUSTOMER_JWT_SECRET exists:",!!process.env.CUSTOMER_JWT_SECRET),console.log("\uD83D\uDD0D [DEBUG] ADMIN_JWT_SECRET exists:",!!process.env.ADMIN_JWT_SECRET),console.log("\uD83D\uDD0D [DEBUG] authConfig.customerJwtSecret:",!!o.customerJwtSecret),console.log("\uD83D\uDD0D [DEBUG] authConfig.adminJwtSecret:",!!o.adminJwtSecret),n=!0),o.customerJwtSecret||e.push("CUSTOMER_JWT_SECRET environment variable is required in production"),o.adminJwtSecret||e.push("ADMIN_JWT_SECRET environment variable is required in production"),e.length>0)?(n||(console.error("⚠️ [WARNING] Authentication configuration errors:",e),console.warn("⚠️ [WARNING] Using fallback secrets in production - this is not secure!")),!1):(n||console.log("✅ [DEBUG] Authentication configuration is valid"),!0)}function a(e){return"customer"===e?o.customerJwtSecret||o.fallbackCustomerSecret:o.adminJwtSecret||o.fallbackAdminSecret}function i(e){let t=[];return e.length<o.minPasswordLength&&t.push(`Password must be at least ${o.minPasswordLength} characters long`),o.requireUppercase&&!/[A-Z]/.test(e)&&t.push("Password must contain at least one uppercase letter"),o.requireLowercase&&!/[a-z]/.test(e)&&t.push("Password must contain at least one lowercase letter"),o.requireNumbers&&!/\d/.test(e)&&t.push("Password must contain at least one number"),o.requireSpecialChars&&!/[!@#$%^&*(),.?":{}|<>]/.test(e)&&t.push("Password must contain at least one special character"),{isValid:0===t.length,errors:t}}},80087:(e,t,r)=>{r.d(t,{RA:()=>s,bw:()=>a,verifyJWT:()=>i,xv:()=>u}),r(87070);var o=r(84770),n=r(60391);function s(e){let t=Math.floor(Date.now()/1e3),r="refresh"===e.type?t+n.aH.refreshTokenExpiry:"admin"===e.type?t+n.aH.adminTokenExpiry:t+n.aH.customerTokenExpiry,s={...e,iat:t,exp:r},a=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),i=Buffer.from(JSON.stringify(s)).toString("base64url"),u=(0,n.Po)("admin"===e.type?"admin":"customer"),c=(0,o.createHmac)("sha256",u).update(`${a}.${i}`).digest("base64url");return`${a}.${i}.${c}`}function a(e,t,r){return s({type:"refresh",userId:e,userType:t,sessionId:r})}function i(e,t){let[r,s,a]=e.split(".");if(!r||!s||!a)throw Error("Invalid token format");let i=JSON.parse(Buffer.from(s,"base64url").toString()),u=(0,n.Po)("admin"===i.type?"admin":"customer");if(a!==(0,o.createHmac)("sha256",u).update(`${r}.${s}`).digest("base64url"))throw Error("Invalid token signature");if(i.exp<Math.floor(Date.now()/1e3))throw Error("Token has expired");if(t&&i.type!==t)throw Error(`Expected token type ${t}, got ${i.type}`);return i}function u(){return(0,o.randomBytes)(32).toString("hex")}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[9276,5972],()=>r(47947));module.exports=o})();